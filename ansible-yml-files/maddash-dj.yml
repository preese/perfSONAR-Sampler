---

- hosts: all
  become: yes
  tasks:
    - name: publish disjoint.json file
      command:  "psconfig publish /home/vagrant/disjoint.json"

    - name: make available to nodes
      command:  'psconfig remote add "http://192.168.1.213/psconfig/disjoint.json"'

    - name: restart psconfig-maddash-agent
      service:
        name: psconfig-maddash-agent
        state: restarted

    - name: restart httpd
      service:
        name: httpd
        state: restarted

- hosts: ps,dj
  gather_fact: False
  become: yes
  tasks:
    - name: install remote URL and archives for disjoint grid
      command: 'psconfig remote  add --configure-archives "http://192.168.1.213/psconfig/disjoint.json"'
      
    - name: restart psconfig-pscheduler-agent
      service:
        name: psconfig-pscheduler-agent
        state: restarted
